<!DOCTYPE html>
<html>

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Z3R0D4RKF0RTY</title>
        <link rel="icon" href="./src/images/favicon.png">
        <!-- <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet"> -->
        <link rel="stylesheet" href="./src/css/app.css">
        <link rel="manifest" href="./manifest.json">
    </head>

    <body>

       <div class="nav-toggle">
            <div class="nav-toggle-bar"></div>
        </div>
       
        <nav class="nav">
            <ul>
                <li><a href="#" onclick="nightMode(event); event.preventDefault();">Home</a></li>
                <li><a href="#">Home</a></li>
                <li><a href="#">Home</a></li>
                <li><a href="#">Home</a></li>
                <li><a href="#">Home</a></li>
            </ul>
        </nav>

        <input id="pac-input1" class="controls search-bar" type="text" placeholder="">

        <input id="pac-input2" class="controls search-bar" style="top: 9rem" type="text" placeholder="Destination">

        <div id="map_canvas"></div>
        <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD8EOCipsqcYeuJP76Ey7MumLdY0ojRmPs&callback=initialize&libraries=geometry,places" type="text/javascript"></script>
        <script src="./src/js/jquery-3.3.1.min.js"></script>
        <script src="./src/js/nav.js"></script>
        <script src="./src/js/app.js"></script>

        <script type="text/javascript">
            
            var map;
            var delhiCenter;
            var userPos;

            if (navigator.geolocation) {
                navigator.geolocation.watchPosition(getPosition);
            } else { 
                userPos = null;
            }

            function getPosition(position) {
                userPos = [position.coords.latitude, position.coords.longitude];
            }

            function initialize() {

                if(userPos == null){
                    delhiCenter = new google.maps.LatLng(28.7041, 77.1025);
                    userPos = delhiCenter;    
                }
                else{
                    userPos = new google.maps.LatLng(userPos[0], userPos[1]);
                }
                
                map = new google.maps.Map(
                
                document.getElementById("map_canvas"), 
                {
                    center: userPos,
                    zoom: 13,
                    mapTypeId: google.maps.MapTypeId.ROADMAP,
                    disableDefaultUI: true,
                    styles: [
                      {
                        "featureType": "poi",
                        "elementType": "labels.text",
                        "stylers": [
                          {
                            "visibility": "off"
                          }
                        ]
                      },
                      {
                        "featureType": "poi.business",
                        "stylers": [
                          {
                            "visibility": "off"
                          }
                        ]
                      },
                      {
                        "featureType": "road",
                        "elementType": "labels.icon",
                        "stylers": [
                          {
                            "visibility": "off"
                          }
                        ]
                      },
                      {
                        "featureType": "transit",
                        "stylers": [
                          {
                            "visibility": "off"
                          }
                        ]
                      }
                    ]
                });

                var marker = new google.maps.Marker({
                    position: userPos,
                    map: map,
                    title: 'Your Location'
                });

                var input1 = document.getElementById('pac-input1');
                var input2 = document.getElementById('pac-input2');
                var searchBox1 = new google.maps.places.SearchBox(input1);
                var searchBox2 = new google.maps.places.SearchBox(input2);
                
                input1.placeholder = "Your Location";
                
                map.addListener('bounds_changed', function() {
                    searchBox1.setBounds(map.getBounds());
                    searchBox2.setBounds(map.getBounds());
                });

                var markers1 = [];
                var markers2 = [];
                var bounds = new google.maps.LatLngBounds();
                
                searchBox1.addListener('places_changed', function() {
                
                    var places = searchBox1.getPlaces();

                    if (places.length == 0) {
                        return;
                    }

                    markers1.forEach(function(marker) {
                        marker.setMap(null);
                    });
              
                    markers1 = [];

                    bounds = new google.maps.LatLngBounds();
              
                    places.forEach(function(place) {
                        if (!place.geometry) {
                            console.log("Returned place contains no geometry");
                            return;
                        }

                        markers1.push(new google.maps.Marker({
                            map: map,
                            title: place.name,
                            position: place.geometry.location
                        }));

                        if (place.geometry.viewport) {
                            bounds.union(place.geometry.viewport);
                        } else {
                            bounds.extend(place.geometry.location);
                        }
                    });

                    marker.setMap(null);
                    
                    map.fitBounds(bounds);
                
                });

                searchBox2.addListener('places_changed', function() {
                
                    var places = searchBox2.getPlaces();

                    if (places.length == 0) {
                        return;
                    }

                    markers2.forEach(function(marker) {
                        marker.setMap(null);
                    });
              
                    markers2 = [];

                    places.forEach(function(place) {
                        if (!place.geometry) {
                            console.log("Returned place contains no geometry");
                            return;
                        }

                        markers2.push(new google.maps.Marker({
                            map: map,
                            title: place.name,
                            position: place.geometry.location
                        }));

                        if (place.geometry.viewport) {
                            bounds.union(place.geometry.viewport);
                        } else {
                            bounds.extend(place.geometry.location);
                        }
                    });
                
                    map.fitBounds(bounds);

                    console.log("WILL COME RIGHT");
                
                });


                // var bounds = new google.maps.LatLngBounds();

                // var jsonData = {
                //     "overview_polyline" : {
                //         "points" : "mtfmDcqsvMbAb@pA\\\\x@Qj@OT?J[FKHSZUt@IRaA|@E@FLJRDTZ|@l@lAbAbC`BzDJ\\Ad@Cn@B\\H\\z@fBLH`C?BjALxBLzBNz@f@`E`@|BxAa@b@ODABLBPDRE@}@XmCx@CNs@PES{C`AoG~A}H`CWp@WrA`AnGG|@LjGH|EEb@PhA`AfE`BbF~AfFhIf[tFlR~Iv\\dJl[XfAHDLPNn@LzAAR]r@@pAYtAwClMYdDOvD]zL_@zCKzDQdCMdE[xIo@fXwA`j@GjCEDc@~IMxD?rAQ~CT@{@fMIM@a@@e@HMBQJuAPBgHsDARR?fA@pCB~GLfABfA@lCYlCc@jC_@fAGfAChA@bAPdAVbAZ`CdA~FrCbGpC~@b@^P`@JdAPfAJfAFfA@nCI~GUlPk@~GWfAEfAAlCTdAPdAV`A^^RZVt@l@v@x@t@v@h@`AnAfCdAvBlAhCd@bAR`@T^r@v@r@x@jBjBnBfBpBbBrBbBx@n@t@t@p@x@l@~@vA|Bd@fAXjAv@tCv@tCXlATjAJnADpAAbDK`DApA?rAHlANnAVlA`@dAf@bAl@~@xA~BdDnFpDbGj@`A`@dA|@pC~@rCd@fAh@~@nAfClAfCd@dA\\hAVlANlAT`DR`DRlA^hAd@`An@~@t@t@x@n@tB~AzEnDlF|DfBlBl@|@h@bA~@pCx@rCz@tCbAlCbApCx@tCv@tC|@pCdC~G`ArCfAjC`ApCz@tCpBrGvBhH~BbHfGdQzBdH~@rCfAlCfAlC|@pCvBrG`CbHzBbHtBjHlBnHt@tC~@pCjC|GxGxPzGxPdAlCxA~BhEhFfEhF`BxBzAzBvD|FtDzFfJbN|AvBf@fA^hAVjALnADpAEpAMlAWlA_@fAg@bAuAbCuAbCoAfC[hASlAa@~C_@|C_A~HOlAEpAHbDH~CCtAIlASjA[jAcAjCc@fA]jASpAKnA?pAHnA`@|C\\~CLnAFpAF`D@bDFlCR`DT~C@rAEnAObDO`DGdDP~Cl@`I^|Cd@|CbAfH~@~HZ~CHnA?pAKbDCnABlAXbDX`Dh@`I`BbSdBnRjB`SPlATlA\\bAl@dAp@x@x@p@|@f@bA\\~@PlABlCO~Gg@hPsAxb@gDzPqApCSdA@dAJdAT`A\\~@f@x@n@v@p@NHp@hBeB_BiCwBFs@]JQ?SMG[Bg@PA?WsBDAm@C_@CCwBFImCoDTE?E{BG}GAS"
                //     }
                // };
                
                // var path = google.maps.geometry.encoding.decodePath(jsonData.overview_polyline.points);
                
                // for (var i = 0; i < path.length; i++) {
                //     bounds.extend(path[i]);
                // }
        
                // var polyline = new google.maps.Polyline({
                //     path: path,
                //     strokeColor: '#FF0000',
                //     strokeOpacity: 0.8,
                //     strokeWeight: 8,
                //     fillColor: '#FF0000',
                //     fillOpacity: 0.35,
                //     map: map
                //     // strokeColor: "#0000FF",
                //     // strokeOpacity: 1.0,
                //     // strokeWeight: 2
                // });
                // polyline.setMap(map);
                // map.fitBounds(bounds);            
            
            }

            function nightMode(event) {

                map = new google.maps.Map(
                
                document.getElementById("map_canvas"), 
                {
                    center: userPos,
                    zoom: 13,
                    mapTypeId: google.maps.MapTypeId.ROADMAP,
                    disableDefaultUI: true,
                    styles: [
                        {elementType: 'geometry', stylers: [{color: '#242f3e'}]},
                        {elementType: 'labels.text.stroke', stylers: [{color: '#242f3e'}]},
                        {elementType: 'labels.text.fill', stylers: [{color: '#746855'}]},
                        {
                          featureType: 'administrative.locality',
                          elementType: 'labels.text.fill',
                          stylers: [{color: '#d59563'}]
                        },
                        {
                          featureType: 'poi',
                          elementType: 'labels.text.fill',
                          stylers: [{visibility: 'off'}]
                        },
                        {
                          featureType: 'poi.park',
                          elementType: 'geometry',
                          stylers: [{color: '#263c3f'}]
                        },
                        {
                          featureType: 'poi.business',
                          stylers: [{visibility: 'off'}]
                        },
                        {
                          featureType: 'poi.park',
                          elementType: 'labels.text.fill',
                          stylers: [{color: '#6b9a76'}]
                        },
                        {
                          featureType: 'road',
                          elementType: 'geometry',
                          stylers: [{color: '#38414e'}]
                        },
                        {
                          featureType: 'road',
                          elementType: 'geometry.stroke',
                          stylers: [{color: '#212a37'}]
                        },
                        {
                          featureType: 'road',
                          elementType: 'labels.text.fill',
                          stylers: [{color: '#9ca5b3'}]
                        },
                        {
                          featureType: 'road.highway',
                          elementType: 'geometry',
                          stylers: [{color: '#746855'}]
                        },
                        {
                          featureType: 'road.highway',
                          elementType: 'geometry.stroke',
                          stylers: [{color: '#1f2835'}]
                        },
                        {
                          featureType: 'road.highway',
                          elementType: 'labels.text.fill',
                          stylers: [{color: '#f3d19c'}]
                        },
                        {
                          featureType: 'transit',
                          stylers: [{visibility: 'off'}]
                        },
                        {
                          featureType: 'transit.station',
                          elementType: 'labels.text.fill',
                          stylers: [{color: '#d59563'}]
                        },
                        {
                          featureType: 'water',
                          elementType: 'geometry',
                          stylers: [{color: '#17263c'}]
                        },
                        {
                          featureType: 'water',
                          elementType: 'labels.text.fill',
                          stylers: [{color: '#515c6d'}]
                        },
                        {
                          featureType: 'water',
                          elementType: 'labels.text.stroke',
                          stylers: [{color: '#17263c'}]
                        }
                    ]
                });
            }

            function dayMode(event) {

                map = new google.maps.Map(
                
                document.getElementById("map_canvas"), 
                {
                    center: userPos,
                    zoom: 13,
                    mapTypeId: google.maps.MapTypeId.ROADMAP,
                    disableDefaultUI: true,
                    styles: [
                      {
                        "featureType": "poi",
                        "elementType": "labels.text",
                        "stylers": [
                          {
                            "visibility": "off"
                          }
                        ]
                      },
                      {
                        "featureType": "poi.business",
                        "stylers": [
                          {
                            "visibility": "off"
                          }
                        ]
                      },
                      {
                        "featureType": "road",
                        "elementType": "labels.icon",
                        "stylers": [
                          {
                            "visibility": "off"
                          }
                        ]
                      },
                      {
                        "featureType": "transit",
                        "stylers": [
                          {
                            "visibility": "off"
                          }
                        ]
                      }
                    ]
                });
            }
        
        </script>

    </body>

</html>